<!DOCTYPE HTML>

<html lang="en-us">

<head>
	<meta charset="utf-8">
	<title>Mojo Integration Tests with LXD - Background Process</title>
	<meta name="author" content="map[name:Tim Kuhlman email:tim@backgroundprocess.com]">

	
	
	<meta name="description" content="">
	

	
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    
	<link href='http://feeds.feedburner.com/BackgroundProcess' rel="alternate" title="Background Process" type="application/atom+xml">
	
	<link rel="canonical" href="http://backgroundprocess.com/code/mojo-integration-tests/">
	<link href="http://backgroundprocess.com//favicon.png" rel="shortcut icon">
	<link href="http://backgroundprocess.com//css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="http://backgroundprocess.com//css/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	
	<link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
  
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-56102734-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	
	
	<script src="http://backgroundprocess.com//js/md5.js"></script>
	<script type="text/javascript">
		$(function(){
			$('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5('tim@backgroundprocess.com') + "?s=160' alt='Profile Picture' style='width: 160px;' />");
		});
	</script>
	
	
</div>

<nav id="main-nav"><ul class="main">
    <li><a href="http://backgroundprocess.com//">Blog</a></li>
    <li><a href="http://backgroundprocess.com//about/">About</a></li>
    <li><a href="http://backgroundprocess.com//tags/">Tags</a></li>
</ul>
</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		
		
			<a class="github" href='https://github.com/tkuhlman' title="GitHub">GitHub</a>
		
		
		
		
			<a class="linkedin" href='http://www.linkedin.com/in/timkuhlman' title="LinkedIn">LinkedIn</a>
		
		
		
		
		
		
		
    	
    	
			<a class="rss" href='http://feeds.feedburner.com/BackgroundProcess' title="RSS">RSS</a>
		
	</div>
</nav>
</header>
			</div>
		</div>
		<div class="mid-col">
			
			<div class="mid-col-container">
				<div id="content" class="inner">
					<div itemscope itemtype="http://schema.org/Blog">
					<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <h1 class="title" itemprop="name">Mojo Integration Tests with LXD</h1>
		<div class="date"><time datetime='Fri, Feb 12, 2016' data-updated="true" itemprop="datePublished">Fri, Feb 12, 2016</time>
</div>
	<div class="entry-content" itemprop="articleBody"><p>I have recently finished building an LXD image for doing integration tests of <a href="https://mojo.canonical.com">Mojo</a>.
I did this because I wanted to be able to reliably test the changes to Mojo that I was making. A repeatable,
standard environment that can run set of integration tests fits the bill.
</p>

<h2 id="using-a-container">Using a Container</h2>

<p>There are a few key advantages I see to doing the integration tests in a container image like this:</p>

<ul>
<li>Having a repeatable environment enables automation, sharing of the environment among developers, using
the environment as a base standard and incremental improvement.</li>
<li>The image can be built to a standard, in this case it runs Ubuntu LTS with the latest distributed versions
of Juju/Mojo and other tooling.</li>
<li>Isolation from the primary dev environment allows for easy cleanup, easier testing of various branches and tests
more easily run in parallel.</li>
</ul>

<h2 id="integration-tests">Integration Tests</h2>

<p>Integration tests themselves I want running because some tests are just not practical to do via
unit tests. This is especially true for code that interacts with a lot of other programs such as Mojo.</p>

<p>In many cases integration tests bring an real world element unit tests don&rsquo;t. For example the Mojo unit tests
cover Juju interactions decently well using the expected Juju status output. However what if that
expected output changes? For example Juju output could change in a way that is harmless and not
noticed so everyone upgrades Juju, then later Mojo changes but the unit tests are all based on the
older output, integration tests will catch this before sending broken code to production.</p>

<p>On the other hand some tests, ie proper parsing of a manifest file, work better as a unit test. In other
situations it perhaps isn&rsquo;t so clear. Have integration tests as a tool in addition to unit tests gives Mojo
developers another way to validate code before merging.</p>

<h2 id="more-information">More Information</h2>

<p>The image can also be used for development of Mojo specs, there is some information on that and more information on using the image in the
image <a href="http://bazaar.launchpad.net/~mojo-maintainers/mojo/trunk/view/head:/contrib/LXD/README.md">readme</a>.
I also made this <a href="https://youtu.be/Q8ll7OsTtMk">screen cast</a> to introduce how I use the image today. I often watch
these screen casts at double speed and recommend you do for this one also.</p>

<p>Now that the base image is done all the Mojo developers can all incrementally add more tests and I look forward to seeing it expand.</p></div>
</article>
					
						<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_button_google_plusone" g:plusone:size=''></a>
	
	
	</div>
	
  	<script type="text/javascript" src='http://s7.addthis.com/js/250/addthis_widget.js#pubid='></script>
  	
</div>

					
					
					<section id="comment">
					    <h1 class="title">Comments</h1>
					    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
					</section>
					
					

<script type="text/javascript">
    
    var disqus_shortname = 'backgroundprocess';

    
    

    
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
    
</script>


				    </div>
				</div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2017

    Tim Kuhlman

| Design based on <a href="https://github.com/cxfksword/greyshade">greyshade</a>
| <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons License</a>
<script src="http://backgroundprocess.com//js/slash.js"></script>
<script src="http://backgroundprocess.com//js/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>
</footer>
		</div>
	</div>
	
</body>
</html>
